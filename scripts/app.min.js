//@prepros-append "../components/menu/menu.js"
//@prepros-append "../components/info/info.js"
//@prepros-append "../components/lang/lang.js"
//@prepros-append "../components/img-holder/img-holder.js"

//@prepros-append "../components/main.js"
$(function(){

	var $element = $('.menu');
	var $menu_items = $('.menu__items');
	var $btn = $('.btns');
	var $item;
	var lan;
	var current_item;
	var content_id;


	if( $element.length<1 ) {
		console.warn('No Menu element found!');
		return;
	}

	var data;

	//console.log('#Menu: element:', $element );
	
	// INIT CONTENT
	$(window).on('main:ready', function( event, _data ) {

		data = _data;

		//HANDLEBARS
		var source = document.getElementById( "tmpl-sidebar-menu" ).innerHTML;
		template = Handlebars.compile(source);

		
		$btn.empty();


		var $adding_btn;

		data.buttons.forEach(function(e, i) {

			console.log('item',i,e);
			$adding_btn = $('<button class="btns__btn">'+e.text+'</button>');
			$adding_btn.appendTo($btn).appendTo($element);

			if( e.theme == "dark" ) {
				$adding_btn.addClass('btns__btn_dark');
			}	
		});


		init_menu( content_id);


	});

	// LANG
	$(window).on("language:changed", function(evt, language_name) {
		//console.log("#Main: language:changed: ["+language_name+"]", evt);
		// var $menu_items_item = $( '.menu__item>a', $element ); 

		// //console.log('$menu_items_item: ', $menu_items_item );

		// $menu_items_item.each(function(i, e ) {
		// 	// console.log(i,e,$(e).parent().data('menu-index'));
		// 	$(e).text( data.menu[ $(e).parent().data('menu-index') ].title[ language_name ] );
		// });
		lan = language_name || data.start_language;
		$menu_items.empty();
		init_menu(content_id);
		
	});


	$(window).on("content:changed", function(evt, _content_id) {
		content_id = _content_id;
		console.log(data.content[content_id].title[lan]);
		$('.menu__item').each(function(i, e) {
			$(e).removeClass('menu__item_active');
			if( data.content[content_id].title[lan] == $(e).text()) {
				$(e).addClass('menu__item_active');
			}

		});
	});

	$menu_items.on("click", function(event) {

		// console.log("CLICK: ", event.target );
		var $item = $(event.target);
		if( $item.hasClass('menu__item') ){
			// $('.menu__item').removeClass('menu__item_active');
			// $item.addClass('menu__item_active');

			// TweenMax.fromTo($item, .6, {
			// 	scale: 1.1
			// }, {
			// 	scale: 1,
			// 	ease: Sine.easeInOut
			// });

			current_item = $item.data('content-id');
			console.log('MENU :> ', current_item );
			router.navigate('/'+current_item );
			
			// $(window).trigger("content:changed", $item.data('content-id') );
		}
	});


	function init_menu(page) {
		$menu_items.empty();
		var _menu = data.menu;
		var menu = {};
		var html = '';
		_menu.forEach( function(e,i) {
			menu.title = e.title[lan];
			menu.href = e.href;
			menu.content_id = e.content_id;
			menu.language = lan;

			html += template(menu);
		});
		$( html ).appendTo( $( '.menu__items' ) );
		//console.log(html);
		_content = data.content[page];
		
		//$('.menu__item:contains('+_content.title[lan]+')').addClass('menu__item_active');

	
	}

});
$(function(){

	var data;
	var template;
	var $menu = $('.menu__items');
	var lan, content_id;
	var $content = $('.content');
	var $info_text = $('.info__text');

	// INIT CONTENT
	$(window).on('main:ready', function( event, _data ) {

		var source = document.getElementById( "tmpl-content-info" ).innerHTML;
		template = Handlebars.compile(source);

		data = _data;
		lan = data.start_language;
		content_id = data.start_content;
	});


	$(window).on('language:changed', function(evt, language_name ){
		$content.empty();
		lan = language_name;
		//init_content();
	});



	$(window).on("content:changed", function(evt, _content_id) {
		content_id = _content_id;
		console.log('CONTENT-ID', content_id);
		init_content();
	});

	function init_content() {

		if( $content.children().length ){
			hideContent();
		} else {
			showContent();
		}
	}

	function hideContent(){

		var _anim_counter = 0;

		$('.info__text').each(function(i,e){
			_anim_counter++;
			TweenMax.to( e, .1, 
			{
				delay: .1 * i,
				opacity: 0,
				ease: Power1.easeInOut,
				onComplete: _checkComplete
			});

		});

		_anim_counter++;
		TweenMax.to($('.info__title'), .2, {
			scale: 1,
			opacity: 0,
			ease: Sine.easeInOut,
			onComplete: _checkComplete
		});

		_anim_counter++;
		TweenMax.to($('.img-holder__pic'), .2,
			{
				scale: 1,
				opacity: 0,
				rotation: 0,
				ease: Sine.easeInOut,
				onComplete: _checkComplete
			});

		function _checkComplete (){
			_anim_counter--;
			//console.log('title anim complete', _anim_counter );
			if( _anim_counter < 1 ) showContent();
		}

	}

	function showContent(){
		$content.empty();
		var _content = data.content[content_id];

		var content = {};
		content.title = _content.title[lan];
		content.texts = _content.texts[lan];
		content.url = _content.img.url;
		content.language = lan;

		var html = template( content );
		$( html ).appendTo( $( '.content' ) );

		$('.info__text').each(function(i,e){

			TweenMax.fromTo( e, .4, {
				opacity: 0,
				y: 50
			}, {
				delay: .1 * i,
				opacity: 1,
				y: 0,
				ease: Power1.easeInOut
			});

		});


		TweenMax.to($('.info__title'), .6, {
			scale: 1.2,
			ease: Sine.easeInOut
		});

		TweenMax.fromTo($('.img-holder__pic'), .6,
			{
				scale: 0.8,
				opacity: 0.4,
				rotation: 5
			},
			{
				scale: 1,
				opacity: 1,
				rotation: 0,
				ease: Sine.easeInOut
			}
		);

	}

});

$(function(){

	var $element = $('.lang');
	if( $element.length<1 ) {
		console.warn('No Lang element fond!');
		return;
	} 

	$element.empty();

	console.log('#Lang: element:', $element );

	// INTIALIZATION
	$(window).on('main:ready', function( event, data ) {

		console.log('#Lang: ', data );
		
		var $adding_el = '<select>';
		data.lang.forEach(function(e,i) {

			$adding_el += '<option>'+ e +'</option>';
		});

		$adding_el+='</select>';
		$($adding_el).appendTo($element);

		console.log("LANG: ", $( $('select', data.start_language )));
		$(window).trigger("language:changed", data.start_language );
	});


	// ON CHANGE LANGUAGE EVENT
	$element.change( function() {
		
		$element.css('border', '6px solid grey');
		var $option = $('select', $element ).val();
		console.log($option);

		$(window).trigger("language:changed", $option );
	});
	
	
});
$(function() {
	var data;


	
	// INIT CONTENT
	$(window).on('main:ready', function( event, _data ) {

		data = _data;

		// var source = document.getElementById( "tmpl-content-img" ).innerHTML;
		// template = Handlebars.compile(source);

		// var _content = data.content['save and multiply'].img;
		// var content = {};
		// content.img = _content.url;
		// content.title = content.title;
	
		// var html = template( content );
		// $( html ).appendTo( $( '.content' ) );

		// console.log("IMG:", content );
	


	});
});
$(function() {
	
	var data;


	//NAVIGO
	var root = null;
	var useHash = true; // Defaults to: false
	var hash = '#'; // Defaults to: '#'
	var router = window.router = new Navigo(root, useHash, hash);

	

	$.get("assets/data.json", function(_data) {

		data = _data;
		console.log('#Main: data is loaded: ', _data );

		data.start_language = data.lang[0];
		
		for ( var i in data.content) {
			data.start_content = i;
			break;
		}

		$(window).trigger('main:ready', data );

		router.on( '/:content', function (params) {
			console.log( 'Navigo: ', params  );
			$(window).trigger("content:changed", params.content );
		}).resolve();
		

	});


	console.log("#Main: main is ready!", data);


	// CHANGE LANGUAGE FOR STATIC CONTENTS
	$(window).on("language:changed", function(evt, language_name) {
		
		// TRANSLATE STATIC TEXTS
		$('[data-trnslt]').each(function(i,e){
			// console.log('=>', i, e);
			var key = $(e).data('trnslt');
			if( !key ) return;
			var trnslt = data.translate[ key ];
			if( !trnslt ) {
				console.warn("there's no a such translation for:", key );
				return;
			}
			$(e).text( trnslt[ language_name ] );
		});

		// TITLE
		var $page_name = $('head title');
		var page_title = data.content[data.start_content].title;
		$page_name.text(page_title[language_name]);

	});


	// WINDOW RESIZE
	$(window).resize(function() {
		var $b = $('body');
		
		$b.toggleClass('is_mobile', window.innerWidth < 768 );
	
		$b.toggleClass('is_tablet', window.innerWidth >= 768 && window.innerWidth < 1024 );
		
		$b.toggleClass('is_desktop', window.innerWidth > 1024);
		
		$(window).trigger("window-size:changed");
	});


	
	
	


});


//# sourceMappingURL=app.min.js.map