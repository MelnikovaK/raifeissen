//@prepros-append "../components/menu/menu.js"
//@prepros-append "../components/lang/lang.js"

//@prepros-append "../components/main.js"
$(function(){

	var $element = $('.menu');
	var $btn = $('.btns');


	if( $element.length<1 ) {
		console.warn('No Menu element found!');
		return;
	}

	var data;

	//console.log('#Menu: element:', $element );
	
	// INIT CONTENT
	$(window).on('main:ready', function( event, _data ) {

		data = _data;

		//console.log('#Menu: ', event, data );
		$element.empty();
		$btn.empty();

		// Generate menu items
		data.menu.forEach(function( e, i ) {
			
			//console.log('item',i,e);
			if( e.title ) {
				
				var $adding_el = 
					$('<p class="menu__item"><a href="'+e.href+'">'+e.title.ru+'</a></p>')
						.appendTo($element)
						.data('menu-index', i );
					;

				// if( data.content.title.ru == e.title.ru ) {
				// 	$adding_el.addClass('menu__item_active');
				// }
			} else {
				$('<div class="menu__line"></div>').appendTo($element);
			}
		});

		var $adding_btn;

		data.buttons.forEach(function(e, i) {

			console.log('item',i,e);
			$adding_btn = $('<button class="btns__btn">'+e.text+'</button>');
			$adding_btn.appendTo($btn).appendTo($element);

			if( e.theme == "dark" ) {
				$adding_btn.addClass('btns__btn_dark');
			}	
		})

	});

	// LANG
	$(window).on("language:changed", function(evt, language_name) {
		console.log("#Main: language:changed: ["+language_name+"]", evt);
		var $menu_item = $( '.menu__item>a', $element ); 

		console.log('$menu_item: ', $menu_item );
		// return;

		// var $add;
		// $menu_item.empty();

		$menu_item.each(function(i,e) {
			console.log(i,e,$(e).parent().data('menu-index'));
			$(e).text( data.menu[ $(e).parent().data('menu-index') ].title[ language_name ] );
			// $add = $('<a href="'+e.href+'">'+e.title.data+'</a>');
			// $add.appendTo($menu_item);
		});
		
	});
		
});
$(function(){

	var $element = $('.lang');
	if( $element.length<1 ) {
		console.warn('No Lang element fond!');
		return;
	} 

	$element.empty();

	console.log('#Lang: element:', $element );

	$(window).on('main:ready', function( event, data) {
		console.log('#Lang: ', data );
		
		var $adding_el = '<select>';
		data.lang.forEach(function(e,i) {

			$adding_el += '<option>'+ e +'</option>';
		});

		$adding_el+='</select>';
		$($adding_el).appendTo($element);
	});

	$($element).change( function(a) {
		
		$($element).css('border', '6px solid grey');
		var $option = $('select').val();
		console.log($option);

		$(window).trigger("language:changed", $option );
	});
	
});
$(function() {
	
	var data;

	$.get("assets/data.json", function(_data) {
		data = _data;
		console.log('#Main: data is loaded: ', _data );

		$(window).trigger('main:ready', data );

	});

	console.log("#Main: main is ready!", data);

});


//# sourceMappingURL=app.min.js.map